#!/usr/bin/env python3

# -*- coding: utf-8 -*-

import math

import rospy

from sensor_msgs.msg import Imu

from geometry_msgs.msg import Quaternion, Vector3

import numpy as np

from scipy.fftpack import fft,fft2, fftshift

import matplotlib.pyplot as plt

from scipy.spatial import distance

###

from message.msg import classification_message

pub = rospy.Publisher('IMU_classification', classification_message , queue_size=5)

message = classification_message()

# Fill in the data information

#message.classification_type = output[0]

#message.intensity = output[1] 

message.area = 0

###

count = 0

acc_x = np.array([])

acc_y = np.array([])

acc_z = np.array([])

acc = np.array([])

magnitude = []

average = 0

shift_magnitude = []

input_average = 0

input_shift_magnitude = []

error_shake = []

error_uplift = []

# Left : 2

shakeL_train = []

upliftL_train = []

SD_shakeL_train = []

SD_upliftL_train = []

freq_L_train = []

# Right : 1

shakeR_train = []

upliftR_train = []

SD_shakeR_train = []

SD_upliftR_train = []

freq_R_train = []

# Choose

shake_train = []

uplift_train = []

SD_shake_train = []

SD_uplift_train = []

freq_train = []


duration = 0

first = 0

# Train Data Set # Already shift 

'''

shake1 = [-2.111337059845433, -2.066408703805045, -1.9821112919181796, -1.5963854455014514, -1.5390464586867036, -1.5123523551569598, -1.4375762190038355, -1.1920491066072918, -1.14776878312993, -0.5784710767594676, -0.1363771811087977, -0.1436363750113614, -0.3749723103125371, -0.46489734952113526, -0.28527050367264817, -0.5243605616602265, 0.3541685005253097, 0.5117067821779964, 0.22022072018134153, -0.08748143570862865, -0.38613223205024383, -0.041466222953774334, -0.2654833721732528, 0.8976056040141858, 1.4078802500455945, 0.979653943732596, 0.5499737533541316, 0.17873366685153336, -0.22695732493968368, -0.49944248829189775, 0.7781573352480784, 1.4881270368430517, 1.0815747640771844, 1.4044428443871633, 0.9637323470695272, 0.7229298623447642, 0.2865390403426131, 1.0651482386197664, 1.505803755008162, 1.059122487325289, 1.0025824398305812, 0.5291952194634622, 0.4462848265411372, 0.1915978183556053, 0.7179489088363864, 0.25685371264303924]

shake2 = [1.393676357354929, 1.9699757495798575, 2.160394443474666, 2.3339445520391022, 1.7968005362179476, 1.7410425134221361, 1.4564853437372927, 1.8962159651181256, 1.6173075837528117, 1.6042989600883901, 1.1800783267837076, 1.5360906165619097, 1.6548422574075188, 1.421412901693171, 1.189920475151725, 0.9392396585201004, 0.7609905628378835, 0.6153336477453193, 0.5262641313474727, 0.4123525084543651, 0.34030174477779784, 0.3647751557602197, 0.07104469904011257, -0.01942839418950637, -0.4784151510539605, -0.40527439690208755, -0.6377112775647014, -0.626044616876035, -0.5936192141413086, -0.4915425723629223, -1.1564366154476913, -1.0614237456142215, -0.9521712824668986, -1.1872885816072816, -1.2069848209235747, -0.9406236768398499, -1.5309332065446286, -1.814000175267886, -1.6518072823530212, -1.6225179119541728, -1.1979937593770011, -1.6258965532307208, -2.1254810065399274, -2.8105977833609543, -2.4890158776608176, -2.357580788587382]

shake3 = [-4.635478867640757, -4.6441650996072426, -4.2229541226281455, -3.6798198253991146, -3.0777076792806817, -3.2231288774240276, -2.7752529697625974, -2.7608374718939412, -2.327410085967486, -1.9041662465401359, -1.361569140146866, -1.3744785959217545, -0.9499032598001538, -0.7302029012089157, -0.3731039936168514, -0.23357926371732418, -0.013324311282170598, 0.12550128346676814, 0.3729005951094102, 0.4980288484481683, 0.6276115211234554, 0.7728249828962372, 0.9638466071330019, 1.1493592106194637, 1.26483927342505, 1.5115975441509821, 1.7110783088758321, 1.757632192850112, 1.9090725611237112, 2.049569781873773, 1.7883429427302655, 1.8648450873075841, 2.200649421582188, 1.8328325379592094, 1.5391463339313294, 1.4587216090389674, 1.2009982483063162, 1.5787113240653223, 1.475320232824071, 1.1717897274424374, 0.9511358087392434, 0.9845941526425577, 1.043837963446867, 1.354579176049178, 1.2800901549704413, 1.84762527970633]

shake4 = [-6.3022291090287625, -6.415129338625508, -6.279513413971474, -5.723222743987634, -5.980384191425285, -5.7851637897474815, -5.680145593603483, -5.18920971508482, -5.122248829018952, -4.422610373911008, -4.693306102684877, -4.5436630999555865, -3.951867283156669, -3.4607787787442392, -2.822424476409539, -2.890817191938406, -2.4369003216811027, -1.6907074076626714, -0.8686978123702378, -0.07454768956388591, 0.714255498996808, 0.5139093719333534, 0.4810105878619879, 1.1257879594856792, 1.5727521364941381, 2.2429209087683883, 2.56092653683635, 2.426668049564263, 2.555303003591135, 2.7930647724394664, 3.1328948511629218, 3.1328800452209418, 3.224866357698758, 3.3649183096650965, 3.5345979306555417, 3.7705825094663172, 4.06076905940238, 4.187618288108391, 4.336322989384669, 4.439546049462523, 4.5947829328319685, 4.796140159204949, 4.980649228996427, 5.174535050527643, 5.214327032050951, 5.401537642760484]

shake5 = [-2.5145193843543105, -3.09385924642365, -2.8308184007934725, -2.315047727590194, -2.9266832746393714, -3.4965510302043232, -3.945692114746623, -2.9572754928438774, -1.8238047508501167, -2.570466728729874, -2.8148235494042124, -2.0045223341340197, -0.8323920597476673, -0.43614568544708465, -0.504958667031473, -0.5122150407303128, -1.0115511985858947, -1.4953988293898428, -1.7379498070509847, -1.3855825762196883, -1.1545466792294103, -0.8445209207537627, -0.8687214057552608, -0.45835010914651075, -0.31365997139684776, -0.44090516975485716, -0.3028552921898191, -0.3693019041794665, 0.15477469711687064, 0.37110300598281043, 0.360450654885347, 0.8550800007471215, 1.6100811550085314, 1.4938824297816078, 1.4698038040298869, 1.9227229985274565, 2.003626108564209, 2.6634477751383265, 3.438719966083414, 3.306272835823023, 4.043486612352425, 4.323652378198353, 4.530991992924956, 4.3187745346075195, 4.571679647915228, 4.524568753635832]

uplift1 = [-3.4307640540587534, -2.4089753902088553, -1.3897267303307412, -0.7027792779315325, -0.5122096041179516, 0.2800305076988696, 0.19802178139880144, 0.697814515234346, 0.8667995740181382, 0.6660266964605768, 0.8090778597826338, 0.9050158588478929, 0.826338778954014, 0.9712747067164296, 1.1588322780995908, 1.1882243163773083, 1.0272567667777501, 0.8599969624441419, 0.7714938789824268, 0.7453062122307426, 0.6674312848870034, 0.6090744465873854, 0.5130752771313727, 0.4420729745990224, 0.3656750325331961, 0.2951734326248001, 0.2217532729173497, 0.15927070396001852, 0.11238239621920965, 0.0663100851573164, -0.01002791911524259, -0.05555317923703296, -0.07817159810171681, -0.11078867363218237, -0.27310603090565433, -0.3325828960509911, -0.4275858668628274, -0.45724637519139755, -0.3944302313190846, -0.41966930471519515, -0.5651555527951775, -0.6132708103379345, -0.6797319814454452, -0.7853747946894112, -0.859071450078928, -0.9175078795143063]

uplift2 = [0.7652303661149435, 0.6134072592604483, 0.428563851004645, 0.29502891579453916, 0.18294766940006912, 0.10326853528317237, -0.009632456775446663, -0.10499942260813189, -0.1858153696838416, -0.3132648784919354, -0.41363225343846644, -0.5230055340885897, -0.6108121587914068, -0.6599344024829517, -0.6454363601125541, -0.6334453428828137, -0.6746261641727438, -0.567274949870952, -0.5720589862390808, -0.43894994198511306, -0.5477871230707008, -0.6093288597350055, -0.4805528232154206, -0.3008922592311558, -0.33362648952430085, -0.32283925834285654, -0.1926374353559721, -0.20345952997381822, -0.15179567911006497, -0.017572100416479053, -0.07197838518751709, -0.12992979836106056, 0.07338061619273262, 0.08899778132291125, 0.0470359752351408, 0.12671634146434396, 0.23617790556154183, 0.46246619000725, 0.4974694904134447, 0.6246820508744468, 0.528330887307356, 0.8149568070090121, 0.9654069689408527, 0.9369433120529127, 1.0119165186863501, 0.9123605212222916]

uplift3 = [0.8753702117881348, 0.8943074034646807, 0.8593446620028429, 0.8267789142900579, 0.794735418550891, 0.74450462695851, 0.6962505671334007, 0.6219803419933569, 0.6054324581944428, 0.5891191119386692, 0.6074256008813004, 0.52094804864144, 0.4026434279906761, 0.36274834261364663, 0.3878256386929406, 0.44661433449434274, 0.31331585112164007, 0.23462701264558383, 0.18875064332515823, 0.18826137268792298, 0.08332578422899406, 0.15415612605125517, 0.09753087755561918, 0.07765417892974735, -0.09146413120932273, -0.13361761509928982, -0.21532888253380644, -0.3121089200664091, -0.45568904505877317, -0.47940014626717975, -0.42562253165603714, -0.5640153983022795, -0.4558618476939156, -0.4964800172158288, -0.48227790377931523, -0.5140427175346263, -0.3957651380336813, -0.6283041018031241, -0.5648603078250822, -0.6670627717063544, -0.6435425773776977, -0.8457437924922493, -0.8647625997824573, -0.8357971359802345, -0.8199162046742048, -0.6819871700833842]

uplift4 = [0.05269822881178765, 0.4928762322661169, 0.48455483433236823, 0.8262688527459434, 0.816889894482808, 0.6414035537170188, 0.4736716995512773, 0.6755281501420369, 0.6713975838803994, 0.6825872058007616, 0.7468233523859689, 0.6245672518952623, 0.41757431614247276, 0.3724371428808344, 0.3515531426787821, 0.29335743536176606, 0.2682913847845989, 0.20299049553295134, 0.17076022061573815, 0.11787686444528811, 0.08045853831091909, 0.04221858939016654, 0.010308837034780804, -0.038024145682416854, -0.06644836206819704, -0.16577833078911874, -0.20837649029859495, -0.2646390853985361, -0.29097790543849866, -0.34308609942610424, -0.4386476989873369, -0.4300070475711344, -0.43295373286998906, -0.47886440376800854, -0.4662821803150865, -0.39306662040951723, -0.4033734811804637, -0.4427150480727362, -0.48190665162381174, -0.44920339613763494, -0.49324395563692924, -0.5594895278410661, -0.6570756197079075, -0.6763191775982587, -0.7600756217401297, -0.5765392246285641]

uplift5 = [0.39216499968590535, -0.3662395133216423, -0.04707584368090467, 0.22111954459677063, 0.6010088573530274, 1.0950118918094973, 0.9569458624104965, 0.5970356782447301, 0.8575982017871149, 0.26426300751365206, 0.40493839389740627, 0.4584050127515371, 0.403527950171791, 0.21244226282591017, 0.35654004427135666, 0.293711116438526, 0.059148332578465634, -0.10483408296610142, -0.1147652139348847, -0.11870191003405983, -0.1762406347003842, -0.13433960200708084, -0.1556249758401913, -0.16752875715892346, -0.16562022977465807, -0.19170322347439583, -0.1946050811192852, -0.207910004491084, -0.18577809687960967, -0.19852606563917963, -0.1941790219662347, -0.22252693520347622, -0.2307076861786297, -0.2532925305840723, -0.2540907739500051, -0.24462444185997567, -0.2635246945671246, -0.2753666380938471, -0.29044805346601965, -0.3052598952013783, -0.32664274621020795, -0.317827858610797, -0.34993296115637706, -0.38650258467203047, -0.3764599599683627, -0.35298113962521604]

freq_train = [ 0.49450549, -0.49450549, -0.48351648, -0.47252747, -0.46153846, -0.45054945, -0.43956044, -0.42857143, -0.41758242, -0.40659341, -0.3956044,  -0.38461538, -0.37362637, -0.36263736, -0.35164835, -0.34065934, -0.32967033, -0.31868132, -0.30769231, -0.2967033,  -0.28571429, -0.27472527, -0.26373626, -0.25274725, -0.24175824, -0.23076923, -0.21978022, -0.20879121, -0.1978022,  -0.18681319, -0.17582418, -0.16483516, -0.15384615, -0.14285714, -0.13186813, -0.12087912, -0.10989011, -0.0989011,  -0.08791209, -0.07692308, -0.06593407, -0.05494505, -0.04395604, -0.03296703, -0.02197802, -0.01098901]

'''

##########################

# Train new set of'

## Uplift L

upliftL_1_1 = [-5.892794527033821, -5.895172416853114, -5.892933191143017, -5.380521021771945, -5.554798615059928, -5.485658330608585, -5.749026303904043, -5.450725787995392, -5.008144837408348, -4.495528393584019, -3.912752909391918, -3.3536718006460453, -3.06726306624388, -3.2213491606326627, -3.505094330472627, -3.5882327909022984, -3.046761662854738, -2.6167590934440472, -2.6972058580643496, -3.100625943535246, -2.913793311107828, -3.2592177574922485, -3.8653659203079545, -4.0214170675115986, -3.4408506142679536, -2.4039708617094195, -1.1294957775242924, 0.21131591184616472, 1.5175026645688598, 2.75977591566083, 3.98934609406059, 4.801830435862005, 4.735518444690529, 5.085163758480592, 5.616383729560775, 5.874572549264988, 5.749850977713754, 5.843206720847915, 6.084331133498347, 6.374802853703979, 6.528752873026896, 6.958962010778341, 7.899381339456298, 8.691349965636697, 9.422571212801074, 9.804512760012706]

upliftL_1_1_freq = [-0.30666667 , -0.3   ,     -0.29333333 ,-0.28666667 ,-0.28    ,   -0.27333333,-0.26666667 ,-0.26       ,-0.25333333 ,-0.24666667 ,-0.24       ,-0.23333333,-0.22666667 ,-0.22       ,-0.21333333 ,-0.20666667 ,-0.2        ,-0.19333333,-0.18666667 ,-0.18       ,-0.17333333 ,-0.16666667 ,-0.16       ,-0.15333333,-0.14666667 ,-0.14       ,-0.13333333 ,-0.12666667 ,-0.12       ,-0.11333333,-0.10666667 ,-0.1        ,-0.09333333 ,-0.08666667 ,-0.08       ,-0.07333333,-0.06666667 ,-0.06       ,-0.05333333 ,-0.04666667 ,-0.04       ,-0.03333333,-0.02666667 ,-0.02       ,-0.01333333 ,-0.00666667]

upliftL_1_2 = [-6.599287290303785, -6.086875120932713, -6.261152714220696, -6.192012429769353, -6.455380403064811, -6.15707988715616, -5.7144989365691155, -5.201882492744787, -4.619107008552685, -4.0600258998068135, -3.7736171654046475, -3.9277032597934305, -4.2114484296333945, -4.294586890063066, -3.7531157620155056, -3.323113192604815, -3.4035599572251174, -3.8069800426960136, -3.6201474102685958, -3.9655718566530163, -4.571720019468723, -4.727771166672366, -4.147204713428721, -3.1103249608701873, -1.8358498766850602, -0.49503818731460303, 0.8111485654080921, 2.0534218165000624, 3.282991994899822, 4.095476336701237, 4.029164345529761, 4.378809659319824, 4.9100296304000075, 5.16821845010422, 5.043496878552986, 5.136852621687147, 5.3779770343375795, 5.668448754543212, 5.822398773866128, 6.252607911617574, 7.19302724029553, 7.984995866475929, 8.716217113640306, 9.098158660851938, 9.447492525642287, 9.844120893544543]

upliftL_1_2_freq =  [-0.30263158 ,-0.29605263, -0.28947368, -0.28289474, -0.27631579, -0.26973684,-0.26315789 ,-0.25657895 ,-0.25       ,-0.24342105 ,-0.23684211 ,-0.23026316,-0.22368421 ,-0.21710526 ,-0.21052632 ,-0.20394737 ,-0.19736842 ,-0.19078947,-0.18421053 ,-0.17763158 ,-0.17105263 ,-0.16447368 ,-0.15789474 ,-0.15131579,-0.14473684 ,-0.13815789 ,-0.13157895 ,-0.125      ,-0.11842105 ,-0.11184211,-0.10526316 ,-0.09868421 ,-0.09210526 ,-0.08552632 ,-0.07894737 ,-0.07236842,-0.06578947 ,-0.05921053 ,-0.05263158 ,-0.04605263 ,-0.03947368 ,-0.03289474,-0.02631579 ,-0.01973684 ,-0.01315789 ,-0.00657895]

upliftL_1_3 = [-5.6169809184141375, -5.623851281928263, -5.613803681702963, -5.58670854969112, -5.3884215166163845, -4.686062011477115, -4.469664227320268, -4.682357484321783, -4.81429667193395, -5.289968610569979, -5.5427937482099905, -5.018591832119055, -4.4156372544640465, -4.124045694751021, -4.132243504377556, -4.020401801914379, -5.010055226258427, -4.420590089411916, -4.76108561081371, -4.977398971344112, -5.357952116852381, -5.122104667160732, -5.110054466882154, -5.254119460709642, -4.073567557656432, -2.89909971984745, -1.6314518250523697, -0.2615032848161043, 1.1090439425779168, 2.4703045472017093, 3.791201654940612, 4.965137394846988, 5.725885454368627, 6.021487971600377, 6.201804295472617, 6.621482699779162, 7.0913477128937314, 7.583549389889064, 8.093220110964932, 8.515090296242299, 8.875312303453576, 9.328752182428783, 9.689423362296466, 10.155810094651713, 10.611380084761759, 11.054578288247129]

upliftL_1_3_freq = [-0.30263158 ,-0.29605263 ,-0.28947368, -0.28289474, -0.27631579 ,-0.26973684,-0.26315789 ,-0.25657895 ,-0.25       ,-0.24342105 ,-0.23684211 ,-0.23026316,-0.22368421 ,-0.21710526 ,-0.21052632 ,-0.20394737 ,-0.19736842 ,-0.19078947,-0.18421053 ,-0.17763158 ,-0.17105263 ,-0.16447368 ,-0.15789474 ,-0.15131579,-0.14473684 ,-0.13815789 ,-0.13157895 ,-0.125      ,-0.11842105 ,-0.11184211,-0.10526316 ,-0.09868421 ,-0.09210526 ,-0.08552632 ,-0.07894737 ,-0.07236842,-0.06578947 ,-0.05921053 ,-0.05263158 ,-0.04605263 ,-0.03947368 ,-0.03289474,-0.02631579 ,-0.01973684 ,-0.01315789 ,-0.00657895]

upliftL_2_1 = [-14.622838880159582, -13.328840095337126, -11.960316145691417, -12.556084929874322, -11.172819597618059, -9.962083937040855, -9.01634432730928, -7.639585082353271, -7.676771057702822, -7.678171190716722, -6.996253773565794, -7.507207194337594, -6.1745946904917925, -4.861506372038614, -3.507336503588798, -2.612816726026388, -1.3724957579338604, -0.7193282200643338, 0.09706841576605996, 0.25126529687251775, -0.21163748659998838, 0.037882453664240145, 0.15005860746898136, 0.9139531370915446, 1.5474453261502266, 2.136360352716034, 2.4291929491821467, 2.610499303904623, 2.927177658851031, 3.399076831691298, 3.826857429020505, 4.365987350062285, 4.894642673870797, 5.678632402785931, 6.043034854727422, 6.58742153763543, 7.060977762581524, 7.682881637249968, 8.029473483896789, 8.426936304432731, 8.671702948616401, 9.272520509369022, 9.723102175516322, 10.167885274957905, 10.868855519869781, 11.776139770499134]

upliftL_2_1_freq = [-0.18326693, -0.17928287, -0.1752988,  -0.17131474 ,-0.16733068, -0.16334661,-0.15936255 ,-0.15537849 ,-0.15139442 ,-0.14741036 ,-0.14342629 ,-0.13944223,-0.13545817 ,-0.1314741  ,-0.12749004 ,-0.12350598 ,-0.11952191 ,-0.11553785,-0.11155378 ,-0.10756972 ,-0.10358566 ,-0.09960159 ,-0.09561753 ,-0.09163347,-0.0876494  ,-0.08366534 ,-0.07968127 ,-0.07569721 ,-0.07171315 ,-0.06772908,-0.06374502 ,-0.05976096 ,-0.05577689 ,-0.05179283 ,-0.04780876 ,-0.0438247,-0.03984064 ,-0.03585657 ,-0.03187251 ,-0.02788845 ,-0.02390438 ,-0.01992032,-0.01593625 ,-0.01195219 ,-0.00796813 ,-0.00398406]

upliftL_2_2 = [-8.948724423858877, -8.946945842772411, -8.927082233528505, -8.43642253118791, -8.305332088123535, -8.855828876989515, -8.356821745442216, -8.39209283995491, -8.843214813714537, -7.932712178443119, -8.42483431794136, -7.694693415190155, -6.557411265376513, -5.349292608158746, -5.944569114457938, -6.022618396019828, -4.880871826668721, -3.5393934321284988, -2.214454472697028, -0.8656306049707538, -1.0346468603246581, -1.4821072979141174, -0.37492646648898464, 0.913122107507558, 2.1854873293597272, 2.9896439939237833, 3.700357657686487, 4.45003756008378, 4.828261413724954, 5.086561322138092, 5.5011727027327595, 5.89397816489849, 6.050867977567798, 6.229724539774628, 6.476001137076009, 6.585640686915561, 6.7379019176233275, 7.0158030392144415, 7.215488520454793, 7.5704680760333485, 7.780690827279008, 8.074626240141663, 8.302092544814998, 8.576319413060054, 8.849731961113248, 9.316648519228293]

upliftL_2_2_freq = [-0.32857143 ,-0.32142857 ,-0.31428571, -0.30714286 ,-0.3,        -0.29285714,-0.28571429 ,-0.27857143 ,-0.27142857 ,-0.26428571 ,-0.25714286 ,-0.25,-0.24285714 ,-0.23571429 ,-0.22857143 ,-0.22142857 ,-0.21428571 ,-0.20714286,-0.2        ,-0.19285714 ,-0.18571429 ,-0.17857143 ,-0.17142857 ,-0.16428571,-0.15714286 ,-0.15       ,-0.14285714 ,-0.13571429 ,-0.12857143 ,-0.12142857,-0.11428571 ,-0.10714286 ,-0.1        ,-0.09285714 ,-0.08571429 ,-0.07857143,-0.07142857 ,-0.06428571 ,-0.05714286 ,-0.05       ,-0.04285714 ,-0.03571429,-0.02857143 ,-0.02142857 ,-0.01428571 ,-0.00714286]

upliftL_2_3 = [-9.578987065455252, -9.97458807598562, -8.94188565519915, -9.31256792601814, -9.174550305207845, -8.54814152345504, -7.281228783399898, -7.8237313817955485, -8.272679370617757, -8.144221187227373, -7.234324506135916, -7.219966754969793, -6.720156427199846, -7.221456728805726, -6.169024455444537, -5.163223514779451, -3.9190234147452694, -2.623664687568219, -1.4492728856631931, -0.14317079313039294, 0.9553173735424725, 0.523357470471641, 0.842652808233959, 1.275192135644927, 1.5349111310784576, 1.8878141948749345, 2.368044301773356, 2.946504137976893, 3.222329095677683, 3.5665525016215334, 3.863545502934116, 3.9841509568692945, 4.156376276489654, 4.391512531457092, 4.516698801602082, 5.149628991313781, 5.882588988543008, 6.65889057371159, 7.450149349630708, 8.244350173815993, 9.174535627490092, 9.764062541449304, 10.253010392403707, 10.911494357798405, 10.676717322140663, 10.71547790425854]

upliftL_2_3_freq = [-0.368 ,-0.36 , -0.352, -0.344, -0.336, -0.328, -0.32,  -0.312 ,-0.304, -0.296,-0.288 ,-0.28  ,-0.272 ,-0.264 ,-0.256 ,-0.248 ,-0.24  ,-0.232 ,-0.224 ,-0.216,-0.208 ,-0.2   ,-0.192 ,-0.184 ,-0.176 ,-0.168 ,-0.16  ,-0.152 ,-0.144 ,-0.136,-0.128 ,-0.12  ,-0.112 ,-0.104 ,-0.096 ,-0.088 ,-0.08  ,-0.072 ,-0.064 ,-0.056,-0.048 ,-0.04  ,-0.032 ,-0.024 ,-0.016 ,-0.008]

upliftL_3_1 = [-6.937841656623453, -6.711001380431683, -7.197633628996411, -8.048718834552695, -7.939770907259748, -7.476825197833666, -8.072005044790341, -8.034687966289747, -7.729042792687965, -8.081470906442334, -8.133396937427259, -7.592639864128374, -6.295436974896898, -4.911665940635421, -3.851393162537266, -3.0386495507856743, -2.0717778023624014, -1.1713875590338008, -1.0659585781107115, -1.0215581917431464, -0.9104149089322116, -0.8649503947361792, -0.5614657612164073, 0.013351401532812446, 0.5954661365487492, 1.0960694202111103, 1.608988863703722, 2.0087305032929166, 1.9534745286231328, 2.422837604476822, 3.0988142878390335, 3.186168704036188, 3.4604378790674915, 4.002933111784998, 4.36212497872868, 4.7992537088281555, 5.573110789083218, 6.45741916091578, 7.443046443111886, 8.409983747881942, 8.539252780122315, 8.72946511623406, 9.515651365862642, 9.23994975074168, 10.228452540084113, 10.974711119742313]

upliftL_3_1_freq = [-0.34074074 ,-0.33333333, -0.32592593 ,-0.31851852 ,-0.31111111, -0.3037037,-0.2962963  ,-0.28888889 ,-0.28148148 ,-0.27407407 ,-0.26666667 ,-0.25925926,-0.25185185 ,-0.24444444 ,-0.23703704 ,-0.22962963 ,-0.22222222 ,-0.21481481,-0.20740741 ,-0.2        ,-0.19259259 ,-0.18518519 ,-0.17777778 ,-0.17037037,-0.16296296 ,-0.15555556 ,-0.14814815 ,-0.14074074 ,-0.13333333 ,-0.12592593,-0.11851852 ,-0.11111111 ,-0.1037037  ,-0.0962963  ,-0.08888889 ,-0.08148148,-0.07407407 ,-0.06666667 ,-0.05925926 ,-0.05185185 ,-0.04444444 ,-0.03703704,-0.02962963 ,-0.02222222 ,-0.01481481 ,-0.00740741]

upliftL_3_2 = [-9.473583186194936, -9.345412528350725, -9.24496696184915, -9.574902814878147, -8.274232622793182, -8.24323412002488, -8.276217238656475, -8.825277108464599, -7.554018574482512, -6.795762316753511, -5.5283642783805105, -4.247083904578361, -2.9859994752211865, -2.7990609661149186, -2.4219799307131797, -2.1444613794522738, -2.1608836035840255, -2.04363336441134, -1.5522681175338118, -1.3016064231437916, -1.3165469392945717, -0.9384107939636088, -0.09070975406541137, 0.03177541688680208, 0.6358934630354813, 1.33871962568106, 1.1795051702821748, 2.102860500525507, 2.6737643763729952, 3.5436636024671806, 4.498894627079977, 5.524683308854007, 6.562001562182024, 6.209794854146105, 5.986346655978393, 5.700163637452855, 5.4445826260477705, 6.302010070830507, 7.18705798253499, 7.509505151566609, 7.3114305013768455, 7.304554129856653, 7.114576321686291, 6.886093711776455, 7.133297204436024, 6.957441901848453]

upliftL_3_2_freq = [-0.32394366, -0.31690141, -0.30985915, -0.3028169 , -0.29577465 ,-0.28873239,-0.28169014 ,-0.27464789 ,-0.26760563 ,-0.26056338 ,-0.25352113 ,-0.24647887,-0.23943662 ,-0.23239437 ,-0.22535211 ,-0.21830986 ,-0.21126761 ,-0.20422535,-0.1971831  ,-0.19014085 ,-0.18309859 ,-0.17605634 ,-0.16901408 ,-0.16197183,-0.15492958 ,-0.14788732 ,-0.14084507 ,-0.13380282 ,-0.12676056 ,-0.11971831,-0.11267606 ,-0.1056338  ,-0.09859155 ,-0.0915493  ,-0.08450704 ,-0.07746479,-0.07042254 ,-0.06338028 ,-0.05633803 ,-0.04929577 ,-0.04225352 ,-0.03521127,-0.02816901 ,-0.02112676 ,-0.01408451 ,-0.00704225]

upliftL_3_3 = [-10.260190075765308, -9.80967700664916, -8.472022936386509, -8.165096365512708, -8.095389669361328, -6.7149154462563905, -7.026785452875833, -7.603451543610323, -6.23836949937451, -5.676458465099211, -4.839296763659456, -3.8524179116752117, -2.9964195205432302, -2.8284800233361276, -2.1628283839282716, -2.050956177151127, -2.6281690758867757, -2.7085192383799086, -2.9122221960507773, -2.92501315027319, -1.748732190902329, -1.3284626440330527, -1.3104645319228982, -0.7739489017712806, -0.4773417370563422, -0.03919885713844451, 0.14393254274018297, 0.7584768114532068, 1.177679911611337, 1.469233131535102, 2.0527610153190192, 2.4519613120090025, 3.049367294796932, 3.9516305657909516, 4.922229264887566, 6.118990268638491, 7.186447830524422, 8.255917690440995, 9.02338915186904, 8.578958251532239, 8.195818672271031, 8.321646191852778, 9.41324884884106, 9.36679233530252, 9.830287515363938, 9.376059157819924]

upliftL_3_3_freq = [-0.21495327, -0.21028037, -0.20560748, -0.20093458, -0.19626168, -0.19158879,-0.18691589 ,-0.18224299 ,-0.17757009 ,-0.1728972  ,-0.1682243  ,-0.1635514,-0.1588785  ,-0.15420561 ,-0.14953271 ,-0.14485981 ,-0.14018692 ,-0.13551402,-0.13084112 ,-0.12616822 ,-0.12149533 ,-0.11682243 ,-0.11214953 ,-0.10747664,-0.10280374 ,-0.09813084 ,-0.09345794 ,-0.08878505 ,-0.08411215 ,-0.07943925,-0.07476636 ,-0.07009346 ,-0.06542056 ,-0.06074766 ,-0.05607477 ,-0.05140187,-0.04672897 ,-0.04205607 ,-0.03738318 ,-0.03271028 ,-0.02803738 ,-0.02336449,-0.01869159 ,-0.01401869 ,-0.00934579 ,-0.0046729 ]

# Uplift R 

upliftR_1_1 = [-5.630144375658172, -5.787578751550611, -5.262701415987811, -4.724059862225606, -4.220663080249814, -3.797852100574816, -3.1780373134696753, -2.7702758280021818, -2.1668769287801006, -1.6807213505121332, -1.1275369280711622, -0.4586010596888075, 0.12728135750520853, -0.05270951229507226, 0.3748889569204845, 0.10218076418051236, 0.702131548177805, 0.5879798374966061, 0.6678173489848307, 0.32419191424939875, -0.22181140223372875, -0.886898763813238, -0.667543312159963, -0.34658022678631983, -0.5701743041528085, -0.8474585398559338, -0.8960010530559455, -0.6531428168232667, -0.4162519514391647, 0.2625578265411077, 0.5667904358537124, 1.3383064371171267, 2.141723251977165, 2.8119338289020472, 3.061226740384827, 3.1514018267832515, 3.1700491368504107, 3.0599454072277315, 3.092133829000323, 3.1509114112992123, 3.0059534375518417, 3.0005146133501395, 3.097435216187968, 3.013448712661793, 2.7605133688999164, 2.7923036692829193]

upliftR_1_1_freq = [-0.30872483 ,-0.30201342 ,-0.29530201 ,-0.2885906 , -0.28187919, -0.27516779,-0.26845638 ,-0.26174497 ,-0.25503356 ,-0.24832215 ,-0.24161074 ,-0.23489933,-0.22818792 ,-0.22147651 ,-0.2147651  ,-0.20805369 ,-0.20134228 ,-0.19463087,-0.18791946 ,-0.18120805 ,-0.17449664 ,-0.16778523 ,-0.16107383 ,-0.15436242,-0.14765101 ,-0.1409396  ,-0.13422819 ,-0.12751678 ,-0.12080537 ,-0.11409396,-0.10738255 ,-0.10067114 ,-0.09395973 ,-0.08724832 ,-0.08053691 ,-0.0738255,-0.06711409 ,-0.06040268 ,-0.05369128 ,-0.04697987 ,-0.04026846 ,-0.03355705,-0.02684564 ,-0.02013423 ,-0.01342282 ,-0.00671141]

upliftR_1_2 = [-4.383789163562537, -4.052710038931525, -4.282288362496276, -4.7490203757172775, -4.22468315628299, -3.5894676388230486, -3.069714750175641, -2.4130959308823967, -2.051242433538235, -1.3773066470189623, -0.7193591229346552, -0.1630631953661501, 0.47422903709713893, 0.7219397301339967, 0.3230401514064658, 0.904604510602371, 0.981241267966455, 0.25727334949989356, 0.05357122953394011, 0.48089939317194297, 0.05856462410398322, 0.30308774232991276, 0.12214500816567764, 0.4606494000331107, 0.28613795263960107, 0.27985823514929997, 0.36123496117463727, 0.3435616039242584, 0.13783548327820316, 0.14445261796589737, 0.07949902656321228, 0.06760141339880033, 0.15497018729663292, 0.42179097238909335, 0.6758469522371291, 1.1976984584423622, 1.4705502499750187, 1.5283221342481879, 2.066563875628039, 2.3864893248945256, 2.6285995901241943, 3.048969302794103, 3.2195132968598648, 3.215269706138046, 3.18574337172907, 3.0339866548346492]

upliftR_1_2_freq = [-0.37398374, -0.36585366, -0.35772358 ,-0.3495935,  -0.34146341, -0.33333333,-0.32520325, -0.31707317, -0.30894309 ,-0.30081301 ,-0.29268293, -0.28455285,-0.27642276 ,-0.26829268 ,-0.2601626 , -0.25203252 ,-0.24390244 ,-0.23577236,-0.22764228 ,-0.2195122 , -0.21138211, -0.20325203, -0.19512195 ,-0.18699187,-0.17886179 ,-0.17073171, -0.16260163, -0.15447154 ,-0.14634146 ,-0.13821138,-0.1300813,  -0.12195122, -0.11382114, -0.10569106 ,-0.09756098 ,-0.08943089,-0.08130081 ,-0.07317073, -0.06504065 ,-0.05691057, -0.04878049 ,-0.04065041,-0.03252033, -0.02439024 ,-0.01626016 ,-0.00813008]

upliftR_1_3 = [-4.836573701458319, -4.9939785085544495, -4.928661303323233, -4.566350004281047, -4.194694368472819, -4.488725973961047, -4.153147220656098, -3.732902115112001, -3.5997551478495224, -3.3090234408394577, -2.767318434282722, -2.3450405275783233, -2.2067387243262733, -1.9061972817257846, -1.320811097834249, -0.7067742821677818, -0.0767574805868465, 0.5478774727146787, 0.49583261676017365, 0.985949991009452, 1.2208658402970451, 1.6691830661750853, 1.4651369863604957, 1.6661269153403566, 1.4268796607797647, 1.3383637106307509, 0.916046121202819, 0.444124846779026, 0.36699298104077815, 0.1319971025496507, 0.0980580111330065, 0.2328484442829204, 0.3468448937727677, 0.6739188665963507, 1.2754387767037905, 1.8418902566172592, 2.428512653523083, 3.253087200270997, 3.653082021226881, 3.8273507177184243, 3.8141004829608036, 3.9542704010266796, 4.0326100258611035, 3.9592963047738525, 4.012784685079719, 4.053978559822273]

upliftR_1_3_freq = [-0.35658915, -0.34883721, -0.34108527,-0.33333333, -0.3255814 , -0.31782946,-0.31007752 ,-0.30232558 ,-0.29457364 ,-0.28682171 ,-0.27906977 ,-0.27131783,-0.26356589 ,-0.25581395 ,-0.24806202 ,-0.24031008 ,-0.23255814 ,-0.2248062,-0.21705426 ,-0.20930233 ,-0.20155039 ,-0.19379845 ,-0.18604651 ,-0.17829457,-0.17054264 ,-0.1627907  ,-0.15503876 ,-0.14728682 ,-0.13953488 ,-0.13178295,-0.12403101 ,-0.11627907 ,-0.10852713 ,-0.10077519 ,-0.09302326 ,-0.08527132,-0.07751938 ,-0.06976744 ,-0.0620155  ,-0.05426357 ,-0.04651163 ,-0.03875969,-0.03100775 ,-0.02325581 ,-0.01550388 ,-0.00775194]

upliftR_2_1 = [-6.957859408269232, -6.801673893637784, -6.369017491455527, -6.142726537948446, -6.438917540803833, -6.423493256124758, -6.792400737570708, -6.083115942449376, -5.973188738916746, -5.020812129280763, -4.598700670935493, -4.280176097596927, -3.453847779505811, -2.163628820018258, -1.252125667749561, -1.4173191772755436, -0.4974580404698594, 0.6269124769199088, 1.2407773873879728, 2.0461792174103204, 2.8575911375229905, 3.2688359655498944, 2.9770293813395865, 2.8170468264791397, 2.7612181242308234, 2.757323577031385, 2.7207329327913508, 2.7638031487462973, 2.7865309501620343, 2.719335940624849, 2.742075917129964, 2.93026224275122, 2.8178670269259376, 2.5879532451615086, 2.6950448029843797, 2.742196485376321, 2.6908216006014856, 2.666472925317252, 2.6967147450948703, 2.7450836751656675, 2.7961982622943227, 2.967788727397127, 3.340759339346275, 3.730200595799146, 3.9859097900334666, 4.187795482433137]

upliftR_2_1_freq = [-0.38016529 ,-0.37190083 ,-0.36363636 ,-0.3553719,  -0.34710744, -0.33884298,-0.33057851 ,-0.32231405 ,-0.31404959 ,-0.30578512 ,-0.29752066 ,-0.2892562,-0.28099174 ,-0.27272727 ,-0.26446281 ,-0.25619835 ,-0.24793388 ,-0.23966942,-0.23140496 ,-0.2231405  ,-0.21487603 ,-0.20661157 ,-0.19834711 ,-0.19008264,-0.18181818 ,-0.17355372 ,-0.16528926 ,-0.15702479 ,-0.14876033 ,-0.14049587,-0.1322314  ,-0.12396694 ,-0.11570248 ,-0.10743802 ,-0.09917355 ,-0.09090909,-0.08264463 ,-0.07438017 ,-0.0661157  ,-0.05785124 ,-0.04958678 ,-0.04132231,-0.03305785 ,-0.02479339 ,-0.01652893 ,-0.00826446]

upliftR_2_2 = [-4.956316344951086, -5.0150895236744075, -5.032951794066368, -5.038059604317239, -5.0229795654973675, -5.031643995700813, -5.0293748904899065, -4.907924296241968, -4.433436694381783, -3.7751143024780727, -3.3796012832499773, -2.7376418753366316, -2.19864008382069, -3.3936931945597033, -3.83969153101172, -4.162637404486955, -3.681306543941475, -2.679396096445516, -2.989801019990224, -2.73291850444137, -1.753066393259921, -0.4600818316883899, -0.253938722867848, -0.7424559902521537, -1.006546412518647, 0.04613196691961097, 1.3019519844321215, 2.557065528300945, 3.42023171140365, 4.130535743403298, 4.685057043657837, 5.360767017918091, 5.859917007300702, 5.430772060757482, 5.3693170870557925, 4.913638731306255, 4.519074304666372, 4.351800786744997, 4.203204550958327, 4.097139620572136, 4.0926067046203745, 4.023505780231751, 3.94246038642979, 3.958197763839461, 3.991203056916934, 3.999729062234273]

upliftR_2_2_freq = [-0.41071429 ,-0.40178571, -0.39285714 ,-0.38392857, -0.375   ,   -0.36607143,-0.35714286 ,-0.34821429 ,-0.33928571 ,-0.33035714 ,-0.32142857 ,-0.3125,-0.30357143 ,-0.29464286 ,-0.28571429 ,-0.27678571 ,-0.26785714 ,-0.25892857,-0.25       ,-0.24107143 ,-0.23214286 ,-0.22321429 ,-0.21428571 ,-0.20535714,-0.19642857 ,-0.1875     ,-0.17857143 ,-0.16964286 ,-0.16071429 ,-0.15178571,-0.14285714 ,-0.13392857 ,-0.125      ,-0.11607143 ,-0.10714286 ,-0.09821429,-0.08928571 ,-0.08035714 ,-0.07142857 ,-0.0625     ,-0.05357143 ,-0.04464286,-0.03571429 ,-0.02678571 ,-0.01785714 ,-0.00892857]

upliftR_2_3 = [-2.658850114145458, -2.5542840842861105, -2.499722898463066, -2.400589502020782, -2.4420768530907204, -2.4720796830074425, -2.5385311017418895, -2.5593343479736115, -2.4341151251619704, -2.1374413568462587, -1.9946847991554102, -1.8457059966811502, -1.724299835365115, -1.7252583134792117, -1.9395531447880177, -2.129921972771579, -1.9924562258698608, -1.9734694240111676, -1.8180976608622896, -1.163007462668248, -1.1197663778733333, -1.4907095836849207, -1.782251404588167, -1.9105657106715497, -1.795653050348168, -1.0807085652933384, -0.1128335134785825, 0.8705919792022438, 1.5446927609619232, 2.74642675661216, 3.182803512251355, 3.8156314180999926, 4.403568197921213, 4.079968509694068, 5.290429983570347, 4.696464378889055, 4.166670458502016, 3.654032149972074, 3.0968757476520503, 2.6031607053076877, 2.21799390816388, 1.815575625452098, 1.5089722866772348, 1.1304834373897918, 0.8202450472228069, 0.6513812447854574]

upliftR_2_3_freq = [-0.16487455 ,-0.16129032 ,-0.15770609, -0.15412186, -0.15053763 ,-0.14695341,-0.14336918 ,-0.13978495 ,-0.13620072 ,-0.13261649 ,-0.12903226 ,-0.12544803,-0.1218638  ,-0.11827957 ,-0.11469534 ,-0.11111111 ,-0.10752688 ,-0.10394265,-0.10035842 ,-0.09677419 ,-0.09318996 ,-0.08960573 ,-0.08602151 ,-0.08243728,-0.07885305 ,-0.07526882 ,-0.07168459 ,-0.06810036 ,-0.06451613 ,-0.0609319,-0.05734767 ,-0.05376344 ,-0.05017921 ,-0.04659498 ,-0.04301075 ,-0.03942652,-0.03584229 ,-0.03225806 ,-0.02867384 ,-0.02508961 ,-0.02150538 ,-0.01792115,-0.01433692 ,-0.01075269 ,-0.00716846 ,-0.00358423]

upliftR_3_1 = [-4.912996985675578, -4.917401409229256, -4.916202798628378, -4.88740718870488, -4.842828471580148, -4.7701304559878706, -4.655468764806436, -4.446421440157639, -4.299046279783772, -4.25690884887905, -4.253466229471165, -4.141071912592857, -3.877949583747368, -3.416661932676784, -2.5450088646320648, -1.96445234370925, -1.4247507529088859, -0.6152895379240189, 0.1618759341212428, 1.0006473291298228, 2.049973054303935, 1.9798453245887533, 1.6247500513442308, 2.1827263096553793, 2.499738036683638, 2.005078996102288, 2.741857023813905, 2.8622192723229922, 3.1527460888863157, 3.0137370481862025, 2.626944996802587, 2.2792359953932255, 1.9575491634268207, 1.9792723659354383, 1.9718000790079806, 1.9085149350587507, 2.0243615989064185, 2.398524724137001, 3.063678742772044, 3.8231105308120448, 3.6631414451754853, 3.372804786799179, 3.1312953574005977, 3.045917340841143, 3.1745318148157438, 3.4475854546723426]

upliftR_3_1_freq = [-0.24210526 ,-0.23684211 ,-0.23157895, -0.22631579, -0.22105263, -0.21578947,-0.21052632 ,-0.20526316 ,-0.2        ,-0.19473684 ,-0.18947368 ,-0.18421053,-0.17894737 ,-0.17368421 ,-0.16842105 ,-0.16315789 ,-0.15789474 ,-0.15263158,-0.14736842 ,-0.14210526 ,-0.13684211 ,-0.13157895 ,-0.12631579 ,-0.12105263,-0.11578947 ,-0.11052632 ,-0.10526316 ,-0.1        ,-0.09473684 ,-0.08947368,-0.08421053 ,-0.07894737 ,-0.07368421 ,-0.06842105 ,-0.06315789 ,-0.05789474,-0.05263158 ,-0.04736842 ,-0.04210526 ,-0.03684211 ,-0.03157895 ,-0.02631579,-0.02105263 ,-0.01578947 ,-0.01052632 ,-0.00526316]

upliftR_3_2 = [-6.221790810801487, -6.085164073521527, -5.994735332954146, -5.66768933397475, -5.339904640178969, -4.886443480718703, -4.093402739133525, -3.3363884623669406, -2.9894709870405496, -3.0374315905020914, -2.5122491818482597, -1.937579646826224, -1.4160419263825847, -1.291560507660206, -1.0008434686175018, -1.3784808859597018, -1.0786662344723084, -1.23638387980645, -1.6167633844070881, -1.5304109247958184, -0.7410568305085263, -0.6789780543501127, -1.0292160002346957, -0.7267472279139717, 0.04720940928526929, -0.06877294460503336, -0.3979396271822182, 0.3000989385111854, 1.0763450256953302, 1.222270153322734, 1.5096417598625482, 1.483782857748496, 1.612293031114735, 2.4052779707120795, 2.926124387125368, 3.532007121935173, 4.295940448919403, 3.9234414941693956, 3.5818789957700723, 4.383252027811817, 4.689613534137987, 5.158209202408031, 5.727106950152098, 5.5545643299736405, 6.013512993116226, 6.851541544991793]

upliftR_3_2_freq = [-0.19491525 ,-0.19067797, -0.18644068, -0.18220339 ,-0.1779661,  -0.17372881,-0.16949153 ,-0.16525424 ,-0.16101695 ,-0.15677966 ,-0.15254237 ,-0.14830508,-0.1440678  ,-0.13983051 ,-0.13559322 ,-0.13135593 ,-0.12711864 ,-0.12288136,-0.11864407 ,-0.11440678 ,-0.11016949 ,-0.1059322  ,-0.10169492 ,-0.09745763,-0.09322034 ,-0.08898305 ,-0.08474576 ,-0.08050847 ,-0.07627119 ,-0.0720339,-0.06779661 ,-0.06355932 ,-0.05932203 ,-0.05508475 ,-0.05084746 ,-0.04661017,-0.04237288 ,-0.03813559 ,-0.03389831 ,-0.02966102 ,-0.02542373 ,-0.02118644,-0.01694915 ,-0.01271186 ,-0.00847458 ,-0.00423729]

upliftR_3_3 = [-5.89060300183068, -6.054640322787913, -6.1319988459111645, -5.414388042382913, -4.897556097270222, -3.6205756086656544, -2.981701591828248, -1.8504883177170983, -1.6329556386006718, -1.2557671859806145, -0.856228894019786, -0.3839006239990388, 0.5388248672775813, 0.48293270556817536, 0.8020038724979681, 0.9945853980186401, 0.8817411203898846, 0.6841953987274927, 0.8724713990222881, 1.0131718454758856, 0.9094179203808963, 0.7866380289926633, 0.7787952175028954, 0.7932631671475816, 0.6516894970563101, 0.6568937665957169, 0.7193558801863906, 0.7515889046601458, 0.8146493823501935, 0.840194836705451, 0.8576334982953684, 0.846499152717545, 0.8716244735123002, 0.9053819180613827, 0.9657364291334352, 0.9875980784596301, 1.0116610769272922, 1.0898367863850718, 1.1777321972676367, 1.4126668283593293, 1.6283400423899614, 2.1202484087962894, 2.7736887076363175, 3.4803856148683874, 3.1554017995085033, 3.71395595011934]

upliftR_3_3_freq = [-0.31292517, -0.30612245, -0.29931973, -0.29251701, -0.28571429 ,-0.27891156,-0.27210884 ,-0.26530612 ,-0.2585034  ,-0.25170068 ,-0.24489796 ,-0.23809524,-0.23129252 ,-0.2244898  ,-0.21768707 ,-0.21088435 ,-0.20408163 ,-0.19727891,-0.19047619 ,-0.18367347 ,-0.17687075 ,-0.17006803 ,-0.16326531 ,-0.15646259,-0.14965986 ,-0.14285714 ,-0.13605442 ,-0.1292517  ,-0.12244898 ,-0.11564626,-0.10884354 ,-0.10204082 ,-0.0952381  ,-0.08843537 ,-0.08163265 ,-0.07482993,-0.06802721 ,-0.06122449 ,-0.05442177 ,-0.04761905 ,-0.04081633 ,-0.03401361,-0.02721088 ,-0.02040816 ,-0.01360544 ,-0.00680272]

 # Shake L

shakeL_1_1 = [-15.753206709669907, -15.420113299683834, -14.551288075764937, -13.390137932567827, -12.116626920139856, -10.840621205720801, -9.54010328947235, -8.25320580019218, -7.245508150967849, -6.8896425441353735, -7.049302273553495, -7.531288502986326, -7.2901497749462845, -6.101723121778734, -6.329330937487509, -6.700185594248985, -6.90921348314453, -6.0533926579069135, -4.929000361967454, -3.821298598141473, -2.777353963197239, -1.6519375014302007, -0.4690093505352344, 0.5870139449208054, 1.7146672321274679, 2.6211244819901864, 3.2248120033848906, 4.359761195799557, 5.494238227313012, 6.2110234827091695, 6.132910563729329, 6.439434610086334, 6.816759078880082, 7.101750225936954, 7.711198704753432, 7.377316420492633, 8.349090703040446, 9.362434320552573, 10.382663557115631, 11.410017560196405, 12.426308208851339, 12.979889437086321, 12.793488311295398, 12.83491979965816, 12.675892003991962, 12.606925975727407]

shakeL_1_1_freq = [-0.25988701 ,-0.25423729 ,-0.24858757 ,-0.24293785, -0.23728814 ,-0.23163842,-0.2259887  ,-0.22033898 ,-0.21468927 ,-0.20903955 ,-0.20338983 ,-0.19774011,-0.1920904  ,-0.18644068 ,-0.18079096 ,-0.17514124 ,-0.16949153 ,-0.16384181,-0.15819209 ,-0.15254237 ,-0.14689266 ,-0.14124294 ,-0.13559322 ,-0.1299435,-0.12429379 ,-0.11864407 ,-0.11299435 ,-0.10734463 ,-0.10169492 ,-0.0960452,-0.09039548 ,-0.08474576 ,-0.07909605 ,-0.07344633 ,-0.06779661 ,-0.06214689,-0.05649718 ,-0.05084746 ,-0.04519774 ,-0.03954802 ,-0.03389831 ,-0.02824859,-0.02259887 ,-0.01694915 ,-0.01129944 ,-0.00564972]

shakeL_1_2 = [-15.296254005825983, -15.385905741247589, -14.69808053430519, -13.390392660547638, -12.168137959816882, -10.851760372321756, -10.195058104714082, -10.702570276460532, -9.485150079923628, -9.606041310978323, -8.841363756160977, -7.5775684464793205, -8.116814810898983, -7.840774256780504, -6.733177820733356, -5.947022191621617, -6.29142578755811, -4.949975485908201, -3.9222371808904537, -2.6809247357586923, -1.5206352409357233, -0.8445706432956062, 0.2600887140350796, 1.4890803319555896, 1.9177852745141788, 1.6447721268192002, 2.496195647667564, 3.418972404937806, 4.341541158769983, 3.9181203485529235, 3.64990835657437, 4.146822418447483, 4.747170063167564, 5.9382879153216575, 7.055969739217625, 8.250126293281491, 9.444907243388412, 10.650524157435784, 11.845581834835047, 11.500662639731301, 12.359641603635504, 13.51033425716839, 14.661878893532402, 15.831238410563236, 16.794483351679474, 17.171748217931196]

shakeL_1_2_freq = [-0.24468085 ,-0.2393617 , -0.23404255, -0.2287234, -0.22340426 ,-0.21808511,-0.21276596 ,-0.20744681 ,-0.20212766 ,-0.19680851 ,-0.19148936 ,-0.18617021,-0.18085106 ,-0.17553191 ,-0.17021277 ,-0.16489362 ,-0.15957447 ,-0.15425532,-0.14893617 ,-0.14361702 ,-0.13829787 ,-0.13297872 ,-0.12765957 ,-0.12234043,-0.11702128 ,-0.11170213 ,-0.10638298 ,-0.10106383 ,-0.09574468 ,-0.09042553,-0.08510638 ,-0.07978723 ,-0.07446809 ,-0.06914894 ,-0.06382979 ,-0.05851064,-0.05319149 ,-0.04787234 ,-0.04255319 ,-0.03723404 ,-0.03191489 ,-0.02659574,-0.0212766  ,-0.01595745 ,-0.0106383  ,-0.00531915]

shakeL_1_3 = [-13.829055776056125, -12.734178184322122, -12.023985815322261, -11.55082114668361, -11.24936573591096, -10.910650940919965, -10.227710038620286, -8.818015884620507, -7.715082661789735, -8.23497964550571, -6.855137900384056, -6.540626661662451, -6.3931843531036625, -5.176295594572727, -3.920930860510543, -4.073697214698145, -4.592978443796122, -3.6216359492601153, -2.505536245901702, -1.1968113297661365, 0.060862205633402056, 1.2026960876868031, 2.450021423242262, 3.3346718975870075, 3.594501207417192, 3.43221172496445, 3.1064519696973214, 3.341714295804316, 3.5516813363001702, 4.288356962231667, 5.1743502333185205, 5.028298160022395, 4.958535398784544, 5.046507112647081, 4.9490203163545345, 5.811708821527933, 6.561506014338168, 7.5749257128155385, 8.61195325799708, 9.638434047133916, 9.475196894771301, 9.228404037276277, 9.59502393037901, 10.403317664154823, 10.495759277618188, 11.25457039370307]

shakeL_1_3_freq = [-0.28395062 ,-0.27777778 ,-0.27160494 ,-0.2654321 , -0.25925926, -0.25308642,-0.24691358 ,-0.24074074 ,-0.2345679  ,-0.22839506 ,-0.22222222 ,-0.21604938,-0.20987654 ,-0.2037037  ,-0.19753086 ,-0.19135802 ,-0.18518519 ,-0.17901235,-0.17283951 ,-0.16666667 ,-0.16049383 ,-0.15432099 ,-0.14814815 ,-0.14197531,-0.13580247 ,-0.12962963 ,-0.12345679 ,-0.11728395 ,-0.11111111 ,-0.10493827,-0.09876543 ,-0.09259259 ,-0.08641975 ,-0.08024691 ,-0.07407407 ,-0.06790123,-0.0617284  ,-0.05555556 ,-0.04938272 ,-0.04320988 ,-0.03703704 ,-0.0308642,-0.02469136 ,-0.01851852 ,-0.01234568 ,-0.00617284]

shakeL_2_1 = [-13.822141843771329, -12.725995020381967, -11.760635428050536, -10.617669990924863, -9.213798740215513, -8.273401014004202, -8.75839230439174, -7.65577359958748, -7.785609098604981, -7.982360495853395, -8.422071509442183, -8.561239353803444, -8.919948770669151, -8.726682611403309, -8.988389897875614, -7.875903837207132, -6.704892517091711, -5.735932332224268, -4.503507288995634, -3.3169552019545154, -2.0363665726947637, -0.8960853627589458, 0.2476986232692333, -0.22422782602806635, 1.0013365731537878, 0.7134062460584243, 1.1656696394625126, 2.3239380151539155, 3.5106828861123613, 3.788957043251239, 4.831572773924632, 5.967691882438972, 6.486925740881025, 7.588556791249632, 8.590780943940361, 9.684044447457156, 10.444685899848325, 10.089280975603737, 11.166552267260284, 11.46403301953068, 11.274005296669737, 12.043858627556853, 12.729760435727028, 12.844372794425814, 12.879597527879879, 12.670572167079117]

shakeL_2_1_freq = [-0.31292517, -0.30612245 ,-0.29931973, -0.29251701, -0.28571429, -0.27891156,-0.27210884 ,-0.26530612 ,-0.2585034  ,-0.25170068 ,-0.24489796 ,-0.23809524,-0.23129252 ,-0.2244898  ,-0.21768707 ,-0.21088435 ,-0.20408163 ,-0.19727891,-0.19047619 ,-0.18367347 ,-0.17687075 ,-0.17006803 ,-0.16326531 ,-0.15646259,-0.14965986 ,-0.14285714 ,-0.13605442 ,-0.1292517  ,-0.12244898 ,-0.11564626,-0.10884354 ,-0.10204082 ,-0.0952381  ,-0.08843537 ,-0.08163265 ,-0.07482993,-0.06802721 ,-0.06122449 ,-0.05442177 ,-0.04761905 ,-0.04081633 ,-0.03401361,-0.02721088 ,-0.02040816 ,-0.01360544 ,-0.00680272]

shakeL_2_2 = [-13.643451804188171, -13.161271149555153, -12.101187647173418, -12.451413354383615, -11.311904593038548, -10.207309452144893, -9.566630061396872, -8.40057272958949, -7.153552636872176, -7.00250611721478, -5.648617718309513, -5.688836705647061, -6.036344629697075, -6.508820166358529, -5.949829492374054, -4.799768836115787, -3.6322758184775754, -2.585529056313714, -1.774155803071837, -0.44932325832070674, 0.8746693017720979, 1.8245811491599166, 1.3349778227427862, 2.1140507421709334, 1.6249048367791783, 1.7344742223961713, 1.4747295383085195, 2.5165323619901176, 3.68894841764107, 3.45440165670526, 3.862833745640815, 4.538186442081743, 5.089513752482388, 6.148572817833374, 7.240713816928237, 7.137078540386101, 7.582082073076789, 7.448432869946183, 7.128836432480282, 8.159026487223285, 8.689708496091951, 9.727504446162408, 10.550057919424548, 11.54685431324531, 11.229100028098044, 11.352528799475378]

shakeL_2_2_freq = [-0.25136612, -0.24590164 ,-0.24043716, -0.23497268, -0.2295082 , -0.22404372,-0.21857923 ,-0.21311475 ,-0.20765027 ,-0.20218579 ,-0.19672131 ,-0.19125683,-0.18579235 ,-0.18032787 ,-0.17486339 ,-0.16939891 ,-0.16393443 ,-0.15846995,-0.15300546 ,-0.14754098 ,-0.1420765  ,-0.13661202 ,-0.13114754 ,-0.12568306,-0.12021858 ,-0.1147541  ,-0.10928962 ,-0.10382514 ,-0.09836066 ,-0.09289617,-0.08743169 ,-0.08196721 ,-0.07650273 ,-0.07103825 ,-0.06557377 ,-0.06010929,-0.05464481 ,-0.04918033 ,-0.04371585 ,-0.03825137 ,-0.03278689 ,-0.0273224,-0.02185792 ,-0.01639344 ,-0.01092896 ,-0.00546448]

shakeL_2_3 = [-8.614018310530033, -7.18872270513735, -6.112912933113311, -6.627810022507354, -6.697336739258876, -6.205560364661274, -6.478156565128575, -6.435798509946534, -5.7479686202190585, -5.59768335099385, -4.463692302225868, -4.517287171741106, -3.279597031569285, -3.6365607971597695, -2.7505347797641857, -1.4318302919092059, -1.947335418235082, -2.0008188772794426, -1.9088164190376684, -0.6744975304623146, 0.4129918040097813, 1.1466532992439245, 1.5307936393453154, 1.2523391057839035, 1.227702544643055, 0.8323953944828641, 1.214966712987394, 1.5444068787588936, 2.630675040947521, 2.2928178236912355, 3.3518996884224173, 3.8060187641479715, 3.703822589985572, 4.747451431241812, 4.489812648845875, 4.585782451424569, 4.413551437520274, 5.332950926059318, 5.644711865428437, 5.382130570864643, 5.088780353471435, 5.191594231584826, 5.420327653522582, 5.323871583790368, 5.959653792455285, 5.788836508220891]

shakeL_2_3_freq = [-0.30065359, -0.29411765 ,-0.2875817,  -0.28104575,-0.2745098,  -0.26797386,-0.26143791 ,-0.25490196 ,-0.24836601 ,-0.24183007 ,-0.23529412 ,-0.22875817,-0.22222222 ,-0.21568627 ,-0.20915033 ,-0.20261438 ,-0.19607843 ,-0.18954248,-0.18300654 ,-0.17647059 ,-0.16993464 ,-0.16339869 ,-0.15686275 ,-0.1503268,-0.14379085 ,-0.1372549  ,-0.13071895 ,-0.12418301 ,-0.11764706 ,-0.11111111,-0.10457516 ,-0.09803922 ,-0.09150327 ,-0.08496732 ,-0.07843137 ,-0.07189542,-0.06535948 ,-0.05882353 ,-0.05228758 ,-0.04575163 ,-0.03921569 ,-0.03267974,-0.02614379 ,-0.01960784 ,-0.0130719  ,-0.00653595]

shakeL_3_1 = [-6.506653756922519, -7.113274598978198, -6.4336797099511, -5.628669807114634, -6.2169357627375375, -4.875387196667508, -3.5207662230299652, -4.009369848161322, -4.287309325640108, -3.654289608225989, -2.731827016527264, -2.364967071108481, -1.9118587637378663, -1.5806968873310447, -1.3221419043772098, -1.847052434922559, -2.3568501709918976, -2.6197646989907604, -1.941541300756362, -0.8131462924118331, -0.9174631572869956, -0.10004138067515989, -0.5721590659643603, 0.01557750322135476, -0.43592566300978675, 0.511074967503788, 0.5822424855763675, 0.1666524077224345, 0.9452382482355492, 1.0160550012268175, 2.0158121044901645, 2.089911669695905, 2.857397864419676, 3.833011298803827, 4.346782375294122, 4.497140900092276, 4.1122975483428, 3.7814450499842476, 4.498479565379446, 4.176412583385435, 4.6934463542907014, 5.235454661819867, 5.889052213775374, 6.220481056628239, 6.166953504192266, 6.1108522814398185]

shakeL_3_1_freq = [-0.28571429, -0.27950311 ,-0.27329193, -0.26708075, -0.26086957 ,-0.25465839,-0.2484472  ,-0.24223602 ,-0.23602484 ,-0.22981366 ,-0.22360248 ,-0.2173913,-0.21118012 ,-0.20496894 ,-0.19875776 ,-0.19254658 ,-0.1863354  ,-0.18012422,-0.17391304 ,-0.16770186 ,-0.16149068 ,-0.1552795  ,-0.14906832 ,-0.14285714,-0.13664596 ,-0.13043478 ,-0.1242236  ,-0.11801242 ,-0.11180124 ,-0.10559006,-0.09937888 ,-0.0931677  ,-0.08695652 ,-0.08074534 ,-0.07453416 ,-0.06832298,-0.0621118  ,-0.05590062 ,-0.04968944 ,-0.04347826 ,-0.03726708 ,-0.0310559,-0.02484472 ,-0.01863354 ,-0.01242236 ,-0.00621118]

shakeL_3_2 = [-9.152285660991073, -9.059362431036725, -9.596795961653811, -10.144339788301497, -8.9396170088801, -7.729533891631076, -8.29411602297941, -7.055252980527278, -5.7769181053927365, -5.119224418055329, -4.467711242209713, -4.490918036817403, -5.013360699981615, -4.407082874220729, -4.683012212067231, -3.717293727277223, -3.9671722277518064, -3.2689402827838663, -2.1513363046239355, -1.2663957389840146, -0.2727151073271852, 0.9414137229820234, 1.5812162846427835, 2.0189607651042962, 1.6561871408777336, 1.4825733564945835, 2.4793703608939985, 2.434719572196858, 1.9885226844128443, 3.080602460793653, 4.071771669711525, 4.749090131491096, 5.118830643681074, 4.666976424052917, 5.298853648966803, 4.918034820956988, 5.95638522468372, 5.557991638697095, 6.286086354310596, 7.1761055124104605, 6.770121894583204, 6.871011345664757, 7.560343984289849, 7.9140808138662155, 8.667249347964349, 9.32688491976427]

shakeL_3_2_freq = [-0.23589744 ,-0.23076923 ,-0.22564103, -0.22051282, -0.21538462, -0.21025641,-0.20512821 ,-0.2        ,-0.19487179 ,-0.18974359 ,-0.18461538 ,-0.17948718,-0.17435897 ,-0.16923077 ,-0.16410256 ,-0.15897436 ,-0.15384615 ,-0.14871795,-0.14358974 ,-0.13846154 ,-0.13333333 ,-0.12820513 ,-0.12307692 ,-0.11794872,-0.11282051 ,-0.10769231 ,-0.1025641  ,-0.0974359  ,-0.09230769 ,-0.08717949,-0.08205128 ,-0.07692308 ,-0.07179487 ,-0.06666667 ,-0.06153846 ,-0.05641026,-0.05128205 ,-0.04615385 ,-0.04102564 ,-0.03589744 ,-0.03076923 ,-0.02564103,-0.02051282 ,-0.01538462 ,-0.01025641 ,-0.00512821]

shakeL_3_3 = [-9.271901320714537, -8.076869051359633, -6.673365785585411, -6.925130744122393, -5.8295746485940025, -5.034446426574846, -4.387024415522193, -4.883885617882862, -4.257295203863888, -3.5362979149933365, -3.2222443119009236, -2.5301928427347633, -1.48926924389853, -0.9584842575106975, -1.4065659167751718, -1.5580856791971804, -1.2274376749010507, -0.0016269879580388391, -0.4471310809574902, 0.2138843210247643, -0.06569179791790347, -0.5167783506018537, -0.9172197806484572, -0.4038763309831861, 0.6243617301193112, 1.4557969506787867, 1.057746095478521, 0.9473524627266912, 1.9322898842613299, 1.9174397324809256, 1.6028210273654455, 1.5544692340550608, 2.4160663304119385, 3.2911869767682607, 4.111768685315765, 4.267967453624774, 4.397862476450159, 4.368092515998878, 4.4999218479825895, 4.199557140943961, 4.430673987887708, 5.064949811240446, 4.7960094315728465, 4.928078584242082, 5.471093239270514, 6.071005465297583]

shakeL_3_3_freq = [-0.28571429, -0.27950311, -0.27329193, -0.26708075 ,-0.26086957, -0.25465839,-0.2484472  ,-0.24223602 ,-0.23602484 ,-0.22981366 ,-0.22360248 ,-0.2173913,-0.21118012 ,-0.20496894 ,-0.19875776 ,-0.19254658 ,-0.1863354  ,-0.18012422,-0.17391304 ,-0.16770186 ,-0.16149068 ,-0.1552795  ,-0.14906832 ,-0.14285714,-0.13664596 ,-0.13043478 ,-0.1242236  ,-0.11801242 ,-0.11180124 ,-0.10559006,-0.09937888 ,-0.0931677  ,-0.08695652 ,-0.08074534 ,-0.07453416 ,-0.06832298,-0.0621118  ,-0.05590062 ,-0.04968944 ,-0.04347826 ,-0.03726708 ,-0.0310559,-0.02484472 ,-0.01863354 ,-0.01242236 ,-0.00621118]

 ## Shake R

shakeR_1_1 = [-7.8187491631875154, -7.017240037736529, -5.820590496958186, -4.627849170275529, -4.34584968721204, -4.7962473839394, -5.1296514055255376, -4.842991806421601, -5.0201041203607755, -5.299300871433706, -5.80629693140353, -6.12788888273329, -6.353536152651987, -5.812469163340108, -6.371288474421041, -5.669268301327147, -4.545772444160028, -3.280023695542045, -2.1812194543604715, -1.5717418703569432, -0.8086885805662369, -0.4220509940791164, 0.3359949916077092, 1.6067298028056918, 1.0991452766273664, 0.8486555184012321, 0.2906038465113667, 1.459625432867476, 1.176734481404587, 1.208175743737522, 0.9814853221305864, 0.47238903947925337, 1.0965554245439328, 2.0467907788232242, 2.000063706885779, 2.86147440409864, 3.9441732333397805, 5.037385362664358, 6.127796290929744, 7.26606189682434, 8.275209634043856, 9.393770675137825, 10.318832714852865, 11.313789198594355, 12.186236722218394, 12.321139589462819]

shakeR_1_1_freq = [-0.26136364, -0.25568182 ,-0.25      , -0.24431818 ,-0.23863636, -0.23295455,-0.22727273 ,-0.22159091 ,-0.21590909 ,-0.21022727 ,-0.20454545 ,-0.19886364,-0.19318182 ,-0.1875     ,-0.18181818 ,-0.17613636 ,-0.17045455 ,-0.16477273,-0.15909091 ,-0.15340909 ,-0.14772727 ,-0.14204545 ,-0.13636364 ,-0.13068182,-0.125      ,-0.11931818 ,-0.11363636 ,-0.10795455 ,-0.10227273 ,-0.09659091,-0.09090909 ,-0.08522727 ,-0.07954545 ,-0.07386364 ,-0.06818182 ,-0.0625,-0.05681818 ,-0.05113636 ,-0.04545455 ,-0.03977273 ,-0.03409091 ,-0.02840909,-0.02272727 ,-0.01704545 ,-0.01136364 ,-0.00568182]

shakeR_1_2 = [-13.38683656687823, -12.087838722354881, -10.749537431974737, -11.377842241038774, -11.559018525354443, -12.076818220806086, -10.787010943319697, -11.413153475729622, -11.725667942902994, -10.450517229588677, -9.291288465723296, -8.260372941977884, -7.547354982305894, -6.286799211881894, -6.864468462965569, -5.6076989926597225, -4.371687503546646, -3.1743356918833765, -1.9770587077474566, -0.9225355305936134, 0.045829319355288334, 0.9399425927549743, 1.7928026062060098, 2.382997185269236, 1.895511517698548, 1.9313318884092574, 2.797553029994681, 3.5867219999955253, 4.158863721624993, 5.232674573574361, 6.3105754494598045, 6.3271808317872384, 5.96798663362928, 5.644713380379361, 6.6111530286705005, 7.466178320221395, 7.681823154210054, 8.613862318372774, 9.481457820290409, 10.070131564323791, 10.879919847315868, 11.695770233104444, 12.024365471633448, 11.859376693777897, 12.039128456597297, 12.479990152577066]

shakeR_1_2_freq = [-0.2987013 , -0.29220779 ,-0.28571429, -0.27922078, -0.27272727, -0.26623377,-0.25974026 ,-0.25324675 ,-0.24675325 ,-0.24025974 ,-0.23376623 ,-0.22727273,-0.22077922 ,-0.21428571 ,-0.20779221 ,-0.2012987  ,-0.19480519 ,-0.18831169,-0.18181818 ,-0.17532468 ,-0.16883117 ,-0.16233766 ,-0.15584416 ,-0.14935065,-0.14285714 ,-0.13636364 ,-0.12987013 ,-0.12337662 ,-0.11688312 ,-0.11038961,-0.1038961  ,-0.0974026  ,-0.09090909 ,-0.08441558 ,-0.07792208 ,-0.07142857,-0.06493506 ,-0.05844156 ,-0.05194805 ,-0.04545455 ,-0.03896104 ,-0.03246753,-0.02597403 ,-0.01948052 ,-0.01298701 ,-0.00649351]

shakeR_1_3 = [-13.276728020622159, -12.06688438285849, -10.820901107205433, -9.80608738433854, -8.77372964063436, -7.862310566303265, -7.539465010820106, -8.102958853536927, -8.203647091973536, -8.809168096962075, -8.802301150569784, -8.304459057464268, -7.083174182683068, -7.616795776936511, -6.9492347744495895, -6.881845085173525, -7.418595302047509, -6.289080137168336, -5.11197770398352, -3.9360860858563615, -2.945605836949108, -1.9444249917774545, -0.817132505583718, 0.2908477324300822, 0.914321469180388, 0.7068395032609818, 0.7397096307389237, 1.6751742398185936, 2.828785873957246, 3.384342524841328, 4.528294599399937, 5.674952802039476, 6.506448320649524, 6.35585935878767, 7.30138529533283, 7.360781060511544, 8.259430691215782, 9.001740206756276, 9.85599477171509, 10.912421776762718, 11.995952572015645, 12.900205285436796, 13.324465070571287, 14.332265624852445, 14.9924467682581, 15.519927567364986]

shakeR_1_3_freq = [-0.25 ,-0.24456522 ,-0.23913043 ,-0.23369565, -0.22826087 ,-0.22282609 ,-0.2173913 , -0.21195652 ,-0.20652174 ,-0.20108696 ,-0.19565217 ,-0.19021739 ,-0.18478261, -0.17934783, -0.17391304 ,-0.16847826 ,-0.16304348 ,-0.1576087,-0.15217391 ,-0.14673913 ,-0.14130435 ,-0.13586957 ,-0.13043478 ,-0.125,-0.11956522 ,-0.11413043 ,-0.10869565 ,-0.10326087 ,-0.09782609 ,-0.0923913,-0.08695652 ,-0.08152174 ,-0.07608696 ,-0.07065217 ,-0.06521739 ,-0.05978261,-0.05434783 ,-0.04891304 ,-0.04347826 ,-0.03804348 ,-0.0326087  ,-0.02717391,-0.02173913 ,-0.01630435 ,-0.01086957 ,-0.00543478]

shakeR_2_1 = [-12.884547806709685, -11.728363331193572, -10.723287490619366, -10.025903549991433, -10.60031319846195, -11.18321472492299, -9.988338736122827, -8.730952772155803, -8.840325916047039, -9.202366945595632, -9.438181723348627, -8.918725969183999, -8.0309256015755, -6.873245298552462, -5.800888375385685, -4.931721618536011, -4.045933848824745, -3.470600878813407, -3.829238878752234, -3.4413609617128014, -2.3895060720637726, -1.2139420865118549, -0.0004026104208847414, 1.002550677075014, 1.7354076511716947, 2.3402626122938184, 3.5280210219021804, 4.154243244832678, 4.864286614459797, 5.620642641550493, 6.3720279702981415, 7.444528543095782, 7.005688945116578, 6.65535300263851, 6.198933964350214, 7.1968509246166015, 8.11363862496718, 9.12688169484301, 9.337749513500935, 9.020705380322404, 9.959663787789914, 10.19565038938348, 10.697625814617133, 11.263580005173267, 11.82122541868707, 12.636769952816316]

shakeR_2_1_freq = [-0.2875 , -0.28125 ,-0.275,   -0.26875, -0.2625,  -0.25625, -0.25  ,  -0.24375,-0.2375  ,-0.23125 ,-0.225   ,-0.21875 ,-0.2125  ,-0.20625 ,-0.2     ,-0.19375,-0.1875  ,-0.18125 ,-0.175   ,-0.16875 ,-0.1625  ,-0.15625 ,-0.15    ,-0.14375,-0.1375  ,-0.13125 ,-0.125   ,-0.11875 ,-0.1125  ,-0.10625 ,-0.1     ,-0.09375,-0.0875  ,-0.08125 ,-0.075   ,-0.06875 ,-0.0625  ,-0.05625 ,-0.05    ,-0.04375,-0.0375  ,-0.03125 ,-0.025   ,-0.01875 ,-0.0125  ,-0.00625]

shakeR_2_2 = [-11.126945548853719, -10.27588913785452, -9.307650694533974, -9.956473853121224, -9.584669641899428, -9.22588143621665, -9.767875975877557, -8.974051893727365, -8.717511953418953, -8.113514217410232, -7.1582340093190755, -6.167893003522222, -5.34847906394249, -4.93906209216686, -3.8588647411074515, -3.005699819624965, -3.6371028968086456, -3.4273088361733386, -2.8775329892480404, -1.6220728712170498, -0.4634949167718361, 0.5001881739496525, 0.8268022156521369, 1.0856482612268223, 0.6747527658457688, 1.4247888820698495, 1.5520306948109717, 1.826395787691359, 2.0770599313943183, 2.7638296206101245, 3.9349651487989448, 3.380608596279071, 4.516452231321715, 5.443343229071779, 5.924420963720458, 6.8149390965319085, 7.605206303651816, 8.747294168546766, 8.426309164412594, 9.10137512839842, 9.12769025487275, 9.26207669361106, 9.727972042837454, 10.56045631804593, 10.882422102745277, 11.369181816718573]

shakeR_2_2_freq = [-0.23 , -0.225, -0.22 , -0.215, -0.21 , -0.205, -0.2,   -0.195, -0.19,  -0.185,-0.18  ,-0.175 ,-0.17  ,-0.165 ,-0.16  ,-0.155 ,-0.15  ,-0.145 ,-0.14  ,-0.135,-0.13  ,-0.125 ,-0.12  ,-0.115 ,-0.11  ,-0.105 ,-0.1   ,-0.095 ,-0.09  ,-0.085,-0.08  ,-0.075 ,-0.07  ,-0.065 ,-0.06  ,-0.055 ,-0.05  ,-0.045 ,-0.04  ,-0.035,-0.03  ,-0.025 ,-0.02  ,-0.015 ,-0.01  ,-0.005]

shakeR_2_3 = [-15.852137905608775, -14.873240306622018, -13.845808670415753, -13.674314692486234, -12.902215632279496, -11.628072683786487, -11.038539918261945, -9.764928796985853, -9.001964080410076, -8.305925571763707, -8.666683193555397, -8.156702444574934, -6.973280854131685, -5.714508666691469, -4.4140673851099255, -3.732828906827619, -3.378780825180586, -2.963660417470358, -1.6953155766891221, -2.0955978921082483, -1.5471620457896034, -1.1456913144853402, 0.007475812880592514, -0.1786880763218086, 0.9229783222305734, 1.1161176338860557, 0.7190176513927575, 1.6426168482305705, 2.398244433760773, 3.2846968671421983, 4.234650885876629, 5.181466306771345, 6.214357653890506, 7.341230229037187, 7.935594511690745, 8.32642889309032, 9.477196127495539, 10.5143157589016, 11.664211242416012, 11.177474562179196, 11.359789586466825, 11.696072312072275, 12.768030037167382, 13.596620474503734, 14.551695314195843, 15.41983439227759]

shakeR_2_3_freq = [-0.22115385, -0.21634615, -0.21153846, -0.20673077, -0.20192308, -0.19711538,-0.19230769 ,-0.1875     ,-0.18269231 ,-0.17788462 ,-0.17307692 ,-0.16826923,-0.16346154 ,-0.15865385 ,-0.15384615 ,-0.14903846 ,-0.14423077 ,-0.13942308,-0.13461538 ,-0.12980769 ,-0.125      ,-0.12019231 ,-0.11538462 ,-0.11057692,-0.10576923 ,-0.10096154 ,-0.09615385 ,-0.09134615 ,-0.08653846 ,-0.08173077,-0.07692308 ,-0.07211538 ,-0.06730769 ,-0.0625     ,-0.05769231 ,-0.05288462,-0.04807692 ,-0.04326923 ,-0.03846154 ,-0.03365385 ,-0.02884615 ,-0.02403846,-0.01923077 ,-0.01442308 ,-0.00961538 ,-0.00480769]

shakeR_3_1 = [-6.11184864160554, -6.16169412141941, -5.019215606090529, -5.349557409373945, -5.536569111182503, -4.582636696506671, -3.751655729478543, -3.4072376494161594, -2.958657797842185, -3.562550082741893, -3.715554767272158, -4.14707619376746, -3.597205017253904, -4.238036549187297, -4.820367212241001, -4.3477855850016525, -3.0591138328517635, -3.3796535557533343, -3.182324687925008, -2.863696054173614, -1.9267465063735028, -0.7569744256167326, 0.16344727655398117, 1.4352535090748564, 0.9622423644374738, 1.7883723939783938, 3.076271399388638, 4.035931956295396, 3.6455064618329054, 3.4758278425659004, 3.249966541946881, 2.675732813073992, 2.8867152576355455, 3.848892940928854, 3.538392761541461, 4.738699604400484, 4.254609311800213, 4.065855407541159, 4.545297999429163, 4.031344835459395, 4.571126055202834, 4.610960095026822, 4.451590925956722, 4.692430706985228, 5.6478011036366595, 6.083887668381863]

shakeR_3_1_freq = [-0.18852459, -0.18442623 ,-0.18032787 ,-0.17622951 ,-0.17213115, -0.16803279,-0.16393443 ,-0.15983607 ,-0.1557377  ,-0.15163934 ,-0.14754098 ,-0.14344262,-0.13934426 ,-0.1352459  ,-0.13114754 ,-0.12704918 ,-0.12295082 ,-0.11885246,-0.1147541  ,-0.11065574 ,-0.10655738 ,-0.10245902 ,-0.09836066 ,-0.0942623,-0.09016393 ,-0.08606557 ,-0.08196721 ,-0.07786885 ,-0.07377049 ,-0.06967213,-0.06557377 ,-0.06147541 ,-0.05737705 ,-0.05327869 ,-0.04918033 ,-0.04508197,-0.04098361 ,-0.03688525 ,-0.03278689 ,-0.02868852 ,-0.02459016 ,-0.0204918,-0.01639344 ,-0.01229508 ,-0.00819672 ,-0.00409836]

shakeR_3_2 = [-6.163547115077674, -4.983144772570381, -5.625624251795664, -5.345833260993065, -5.887397012837588, -4.677056957004676, -4.927002109810283, -5.5692882107261354, -4.416105798877879, -4.179075695963075, -3.521811894024718, -3.618476566166022, -3.2920592595205846, -2.962645479231801, -2.307812742528866, -1.436475051337089, -0.35836794218187684, 0.675099660111413, 0.22455279698185304, -0.34114009400816503, -0.8708217941288812, -1.4517835548132245, -1.3732417507113208, -0.4430716250329514, -0.4910230877736552, 0.43742401688021904, 1.5191386616677258, 1.7182238741899303, 2.304586715802121, 2.844233580187063, 2.2914295051618625, 2.9840897021622164, 2.8377959700200543, 3.4190165963186407, 3.663882690187637, 4.714154291128692, 4.309285587274853, 4.79539743420665, 4.605130622892731, 4.144035865107891, 3.7236684386748182, 3.942087180041308, 4.928897013868331, 4.681110228280578, 4.549432001637499, 4.93013359433145]

shakeR_3_2_freq = [-0.20353982 ,-0.19911504 ,-0.19469027, -0.19026549, -0.18584071, -0.18141593,-0.17699115 ,-0.17256637 ,-0.16814159 ,-0.16371681 ,-0.15929204 ,-0.15486726,-0.15044248 ,-0.1460177  ,-0.14159292 ,-0.13716814 ,-0.13274336 ,-0.12831858,-0.12389381 ,-0.11946903 ,-0.11504425 ,-0.11061947 ,-0.10619469 ,-0.10176991,-0.09734513 ,-0.09292035 ,-0.08849558 ,-0.0840708  ,-0.07964602 ,-0.07522124,-0.07079646 ,-0.06637168 ,-0.0619469  ,-0.05752212 ,-0.05309735 ,-0.04867257,-0.04424779 ,-0.03982301 ,-0.03539823 ,-0.03097345 ,-0.02654867 ,-0.02212389,-0.01769912 ,-0.01327434 ,-0.00884956 ,-0.00442478]

shakeR_3_3 = [-7.7710556449519235, -7.5689150331175234, -7.078116478939792, -6.5972552886703975, -6.905682553728358, -7.678129642397844, -6.548055866427413, -7.1862686482783, -5.959042899452079, -5.2853160373212535, -5.006968671686726, -3.9150220776989375, -4.547660621868382, -3.8552420545205113, -3.463622095528902, -2.689672385211656, -1.4155398366392653, -1.5959988786318418, -1.4718508626556588, -1.399063577996543, -1.681135760075347, -1.7933869775045865, -0.8593772526192174, 0.1630862012095866, 1.3782660996450273, 0.8139895974467413, 1.9046194825661251, 1.674788260194494, 2.3883594250559783, 2.9535171578035113, 2.7133091868214345, 3.628945660071179, 4.772564724250327, 5.66717961164565, 5.908342639885535, 5.89416168995296, 5.808698141335673, 5.431085732039262, 4.994021469144706, 5.9428886529909315, 5.732710742048476, 6.6124315093455275, 7.515511447453343, 7.1421463812334745, 6.786627197746404, 6.44512813603608]

shakeR_3_3_freq = [-0.2987013  ,-0.29220779, -0.28571429, -0.27922078 ,-0.27272727, -0.26623377,-0.25974026 ,-0.25324675 ,-0.24675325 ,-0.24025974 ,-0.23376623 ,-0.22727273,-0.22077922 ,-0.21428571 ,-0.20779221 ,-0.2012987  ,-0.19480519 ,-0.18831169,-0.18181818 ,-0.17532468 ,-0.16883117 ,-0.16233766 ,-0.15584416 ,-0.14935065,-0.14285714 ,-0.13636364 ,-0.12987013 ,-0.12337662 ,-0.11688312 ,-0.11038961,-0.1038961  ,-0.0974026  ,-0.09090909 ,-0.08441558 ,-0.07792208 ,-0.07142857,-0.06493506 ,-0.05844156 ,-0.05194805 ,-0.04545455 ,-0.03896104 ,-0.03246753,-0.02597403 ,-0.01948052 ,-0.01298701 ,-0.00649351]

##########################

frequency_shake = 0

frequency_uplift = 0

def variance(data):
    
    # Number of observations

    n = len(data)

    #Mean of the data

    mean = sum(data) / n

    # Square deviations

    deviations = [(x - mean) ** 2 for x in data]

    # Variance

    variance = sum(deviations) / n
    
    return variance

for i in range(0,len(shakeL_1_1)) :

    # Left : 2

    shakeL_train.append((shakeL_1_1[i]+shakeL_1_2[i]+shakeL_1_3[i]+shakeL_2_1[i]+shakeL_2_2[i]+shakeL_2_3[i]+shakeL_3_1[i]+shakeL_3_2[i]+shakeL_3_3[i])/9)

    SD_shakeL_train.append(variance([shakeL_1_1[i],shakeL_1_2[i],shakeL_1_3[i],shakeL_2_1[i],shakeL_2_2[i],shakeL_2_3[i],shakeL_3_1[i],shakeL_3_2[i],shakeL_3_3[i]]))


    upliftL_train.append((upliftL_1_1[i]+upliftL_1_2[i]+upliftL_1_3[i]+upliftL_2_1[i]+upliftL_2_2[i]+upliftL_2_3[i]+upliftL_3_1[i]+upliftL_3_2[i]+upliftL_3_3[i])/9)

    SD_upliftL_train.append(variance([upliftL_1_1[i],upliftL_1_2[i],upliftL_1_3[i],upliftL_2_1[i],upliftL_2_2[i],upliftL_2_3[i],upliftL_3_1[i],upliftL_3_2[i],upliftL_3_3[i]]))


    freq_L_train.append((shakeL_1_1_freq[i]+shakeL_1_2_freq[i]+shakeL_1_3_freq[i]+shakeL_2_1_freq[i]+shakeL_2_2_freq[i]+shakeL_2_3_freq[i]+shakeL_3_1_freq[i]+shakeL_3_2_freq[i]+shakeL_3_3_freq[i]+upliftL_1_1_freq[i]+upliftL_1_2_freq[i]+upliftL_1_3_freq[i]+upliftL_2_1_freq[i]+upliftL_2_2_freq[i]+upliftL_2_3_freq[i]+upliftL_3_1_freq[i]+upliftL_3_2_freq[i]+upliftL_3_3_freq[i])/18)

    #print(len(shakeL_train))
    #print(len(SD_shakeL_train))

    #print(len(upliftL_train))

    #print('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx')
    #print(len(SD_upliftL_train))

    #print(len(freq_L_train))

    # Right : 1 

    shakeR_train.append((shakeR_1_1[i]+shakeR_1_2[i]+shakeR_1_3[i]+shakeR_2_1[i]+shakeR_2_2[i]+shakeR_2_3[i]+shakeR_3_1[i]+shakeR_3_2[i]+shakeR_3_3[i])/9)

    SD_shakeR_train.append(variance([shakeR_1_1[i],shakeR_1_2[i],shakeR_1_3[i],shakeR_2_1[i],shakeR_2_2[i],shakeR_2_3[i],shakeR_3_1[i],shakeR_3_2[i],shakeR_3_3[i]]))


    upliftR_train.append((upliftR_1_1[i]+upliftR_1_2[i]+upliftR_1_3[i]+upliftR_2_1[i]+upliftR_2_2[i]+upliftR_2_3[i]+upliftR_3_1[i]+upliftR_3_2[i]+upliftR_3_3[i])/9)

    SD_upliftR_train.append(variance([upliftR_1_1[i],upliftR_1_2[i],upliftR_1_3[i],upliftR_2_1[i],upliftR_2_2[i],upliftR_2_3[i],upliftR_3_1[i],upliftR_3_2[i],upliftR_3_3[i]]))


    freq_R_train.append((shakeR_1_1_freq[i]+shakeR_1_2_freq[i]+shakeR_1_3_freq[i]+shakeR_2_1_freq[i]+shakeR_2_2_freq[i]+shakeR_2_3_freq[i]+shakeR_3_1_freq[i]+shakeR_3_2_freq[i]+shakeR_3_3_freq[i]+upliftR_1_1_freq[i]+upliftR_1_2_freq[i]+upliftR_1_3_freq[i]+upliftR_2_1_freq[i]+upliftR_2_2_freq[i]+upliftR_2_3_freq[i]+upliftR_3_1_freq[i]+upliftR_3_2_freq[i]+upliftR_3_3_freq[i])/18)

    #print(len(shakeR_train))
    #print(len(SD_shakeR_train))

    #print(len(upliftR_train))
    #print(len(SD_upliftR_train))

    #print('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx')

    #print(len(freq_R_train))

def callback(data):

    global acc_x

    global acc_y

    global acc_z

    global acc

    global count

    global magnitude 

    global average

    global input_average

    global shift_magnitude

    global input_shift_magnitude

    global error_shake

    global error_uplift

    global SD_shake_train

    global SD_uplift_train

    global frequency_uplift
    
    global frequency_shake

    global duration

    global first

    error_shake = []

    error_uplift = []

    output = []

    ## For Duration ##

    print(data.header.frame_id)

    print(type(data.header.frame_id))

    if data.header.frame_id == 'base_imu2' :

        shake_train = shakeL_train

        uplift_train = upliftL_train

        freq_train = freq_L_train

        SD_shake_train = SD_shakeL_train

        SD_uplift_train = SD_upliftL_train

        print("LEFTTTTTTTTTTTTTTTTTTTTTTT > 2")

        #print(len(shake_train))

        #print(len(uplift_train))

        #print(len(freq_train))

        #print(len(SD_shake_train))

        #print(len(SD_uplift_train))

    else :

        shake_train = shakeR_train

        uplift_train = upliftR_train

        freq_train = freq_R_train   

        SD_shake_train = SD_shakeR_train

        SD_uplift_train = SD_upliftR_train

        print("RIGHTTTTTTTTTTTTTTTTTTTTTtt > 1")
        
        #print(len(shake_train))

        #print(len(uplift_train))

        #print(len(freq_train))

        #print(len(SD_shake_train))

        #print(len(SD_uplift_train))

    if duration == 0 :

        first = rospy.get_time()

    else :

        first = first 

    # Data raw array from imu rosbag

    acc_x = np.append(acc_x , data.linear_acceleration.x)

    acc_y = np.append(acc_y , data.linear_acceleration.y)

    acc_z = np.append(acc_z , data.linear_acceleration.z)

    acc = np.append(acc , math.sqrt((acc_x[count]**2)+(acc_y[count]**2)+(acc_z[count]**2)))

    #print(acc)

    # DTFT 

    #print(acc_x)
  
    sp = np.fft.fft(np.sin(acc)) # Compute the one-dimensional discrete Fourier Transform

    #print(sp)

    freq = np.fft.fftfreq(acc.shape[0]) # Return the Discrete Fourier Transform sample frequencies.

    #plt.plot(freq, sp.real, freq, sp.imag)

    magnitude.append(math.sqrt((sp.real[count]**2)+(sp.imag[count]**2))) # find magnitude from sqrt(real**2+imag**2)

    if count > 44 :

        input_average = 0

        input_shift_magnitude = []

        # find avg
    
        for i in range(count-45,count+1) :

            input_average += magnitude[i]

        input_average = input_average / 46

        # shift Graph

        for j in range(0,count+1):
            
            input_shift_magnitude.append(magnitude[j]-input_average)

        # compare with train data

        u = 0

        #print(len(shake_train))

        #print(len(freq_train))

        #print(len(input_shift_magnitude))

        #print(len(freq))        

        #print(len(uplift_train))

        for k in range(count-45,count+1):

            error_shake.append(distance.euclidean([shake_train[u], freq_train[u]], [input_shift_magnitude[k] , freq[k]]))

            error_uplift.append(distance.euclidean([uplift_train[u], freq_train[u]], [input_shift_magnitude[k] , freq[k]]))

            u += 1

        ##print(error_uplift)

        ##print(error_shake)

        #print(len(shake_train))

        #print(shake_train)

        #print(len(freq_train))

        #print(freq_train)

        #print(len(input_shift_magnitude))

        #print(input_shift_magnitude)

        #print(len(freq))

        #print(freq)

        #print(error_shake)

        #print(len(error_shake))

        #print(len(error_uplift))

        print(error_uplift)

        #print(len(SD_shake_train))
        
        print((SD_uplift_train))

        #print(freq_train)

        # Check SD

        #print(len(SD_uplift_train))

        #print(len(error_uplift))

        if (all(2*-SD_uplift_train[j] < error_uplift[j] <= 2*SD_uplift_train[j] for j in range(0,46))) == True :

            if max(magnitude[count-45:count+1]) < 7 :

                #print(magnitude[count-45:count+1])
    
                print("UPLIFTTTTTTTTTTTTTTTTTTTTTTTTTTTTT Level 1")

                output = ["lift",1]

            elif 7 <= max(magnitude[count-45:count+1]) < 13 :

                #print(magnitude[count-45:count+1])
        
                print("UPLIFTTTTTTTTTTTTTTTTTTTTTTTTTTTTT Level 2")

                output = ["lift",2]

            else :

                #print(magnitude[count-45:count+1])
            
                print("UPLIFTTTTTTTTTTTTTTTTTTTTTTTTTTTTT Level 3")

                output = ["lift",3]

            seconds = rospy.get_time()

            duration += seconds - first

            frequency_uplift += 1

            if frequency_uplift >= 200 :
        
                frequency_uplift = 1

            message.duration = duration

            message.frequency = frequency_uplift

        elif (all(2*-SD_shake_train[k] < error_shake[k] <= 2*SD_shake_train[k] for k in range(0,46))) == True :

            if max(magnitude[count-45:count+1]) < 7 :

                #print(magnitude[count-45:count+1])
        
                print("Shakeeeeeeeeeeeeee Level 1")

                output = ["shake",1]

            elif 7 <= max(magnitude[count-45:count+1]) < 13 :

                #print(magnitude[count-45:count+1])

                output = ["shake",2]
        
                print("Shakeeeeeeeeeeeeee Level 2")

            else :
                
                #print(magnitude[count-45:count+1])
                
                print("Shakeeeeeeeeeeeeee Level 3")

                output = ["shake",3]

            seconds = rospy.get_time()

            duration += seconds - first

            frequency_shake += 1

            if frequency_shake >= 200 :
            
                frequency_shake = 1

            message.frequency = frequency_shake

        else :

            print("Nooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo")

            output = ["hug",0]

            message.frequency = 0

            duration = 0

        message.duration = duration

        message.classification_type = output[0]

        message.intensity = output[1]

        pub.publish(message)

    
        #plt.scatter(freq[count-45:count+1] , input_shift_magnitude[count-45:count+1] ,color='red')

        #plt.ylim(-10, 20)

        #plt.xlabel('Frequency')

        #plt.ylabel('Magnitude')

        #plt.show()

    '''
    # Check & Train Data

    if count > 44 : # 0-90 >> 91 point >> select 46 point back

        average = 0

        shift_magnitude = []

        for i in range(count-45,count+1):
    
            average += magnitude[i]

        average = average / 46

        print(average)

        for j in range(0,count+1):
        
            shift_magnitude.append(magnitude[j]- average)

        #print(freq[45:91])

        #print(shift_magnitude[45:91])

        #plot graph

        #plt.scatter(freq[45:91], shake3 ,color='red')

        #plt.scatter(freq_train, uplift_train ,color='red')

        print('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx')

        print(len(shift_magnitude[count-45:count+1]))

        print(shift_magnitude[count-45:count+1])

        print(len(freq[count-45:count+1]))

        print(freq[count-45:count+1])

        plt.scatter(freq[count-45:count+1] , shift_magnitude[count-45:count+1] ,color='red')

        plt.ylim(-20, 20)

        plt.xlabel('Frequency')

        plt.ylabel('Magnitude')

        plt.show()

    '''

    #print(freq)

    print(count)

    count += 1

def listener1():

    rospy.init_node('IMU', anonymous=True)

    rospy.Subscriber("imu1", Imu , callback) #Right

    #rospy.Subscriber("imu2", Imu , callback) #Left
        
    rospy.spin()

if __name__ == '__main__':

    listener1()

